<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>M-SECURITY | è³‡æ–™åº«ç®¡ç†å¾Œå°</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { background-color: #000; color: #00f2ff; font-family: sans-serif; padding: 10px; margin: 0; }
        .section { background: #111; padding: 12px; border-radius: 8px; border: 1px solid #333; margin-bottom: 15px; }
        h2 { color: #4da1ff; font-size: 14px; border-left: 4px solid #00f2ff; padding-left: 8px; margin-top: 0; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px; }
        input, select { background: #1a1a1a; border: 1px solid #444; color: #fff; padding: 10px; font-size: 14px; width: 100%; box-sizing: border-box; }
        .btn { background: #00f2ff; color: #000; border: none; padding: 12px; font-weight: bold; width: 100%; border-radius: 4px; font-size: 14px; }
        .btn-vip { background: #ffca28; margin-top: 8px; }
        .btn-red { background: #ff4d4f; color: #fff; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; margin-top: 10px; }
        th { text-align: left; color: #4da1ff; padding: 8px; border-bottom: 1px solid #333; }
        td { padding: 8px; border-bottom: 1px solid #222; color: #ccc; }
        .status-bar { font-size: 10px; color: #888; margin-bottom: 10px; display: flex; justify-content: space-between; }
    </style>
</head>
<body>

    <div style="padding: 5px;">
        <h1 style="font-size: 18px; margin: 5px 0;">M-SECURITY è³‡æ–™åº«ç®¡ç†å¾Œå°</h1>
        <div class="status-bar">
            <span>UNIT: HQ-COMMANDER | STATUS: ONLINE</span>
            <span>2026/2/27</span>
        </div>

        <div class="section">
            <h2>ğŸ‘¥ å“¡å·¥éƒ¨ç½² / ğŸ›‘ ç®¡åˆ¶é»‘åå–® / ğŸ’ VIP</h2>
            <div class="grid">
                <input type="text" id="eID" placeholder="å·¥è™Ÿ/è»Šç‰Œ">
                <input type="text" id="eName" placeholder="å§“å">
            </div>
            <div class="grid">
                <input type="text" id="eDept" placeholder="å–®ä½/è·ç¨±/é»‘å–®åŸå› ">
                <input type="text" id="ePlate" placeholder="è»Šç‰Œ (é¸å¡«)">
            </div>
            <div class="grid">
                <button class="btn" onclick="upData('employee_list')">åŒæ­¥ä¸€èˆ¬å“¡å·¥</button>
                <button class="btn btn-red" onclick="upData('blacklist_data')">ç™¼å¸ƒé»‘åå–®</button>
            </div>
            <button class="btn btn-vip" onclick="upData('vip_list')">ğŸ’ éƒ¨ç½² VIP è‘£ç›£äº‹è³‡æ–™</button>
        </div>

        <div class="section">
            <h2>ğŸ“¡ å‰ç·šå³æ™‚ç‹€æ…‹ç›£æ§</h2>
            <div class="grid">
                <div>
                    <h3 style="font-size:12px; color:#4da1ff;">æœ€è¿‘è¨ªå®¢</h3>
                    <div id="vLogs"></div>
                </div>
                <div>
                    <h3 style="font-size:12px; color:#4da1ff;">æœ€æ–°äº¤æ¥</h3>
                    <div id="dLogs"></div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ• K9 è‡¨åºŠç´€éŒ„æ›´æ–°</h2>
            <div class="grid">
                <select id="k9Name">
                    <option value="å¸ƒä¸">å¼µå¸ƒä¸</option><option value="å°ç™½">è”¡å°ç™½</option>
                    <option value="å°èŠ±">è”¡å°èŠ±</option><option value="ä¾†é †">ä¾†é †</option>
                </select>
                <input type="text" id="k9Note" placeholder="è¼¸å…¥ç‹€æ³ç´€éŒ„">
            </div>
            <button class="btn" onclick="upK9()">æ›´æ–° K9 ç‹€æ…‹</button>
        </div>
    </div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyB2_tKKsVT4kdW7PPkJgI9O7S1YdCWor48",
        databaseURL: "https://factor-security-d1965-default-rtdb.firebaseio.com",
        projectId: "factor-security-d1965",
        appId: "1:864846943143:web:4cfa18cd20d2f712225c82"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // æ ¸å¿ƒæ•¸æ“šåŒæ­¥ (æœƒå— auth != null ä¿è­·)
    function upData(path) {
        const id = document.getElementById('eID').value.trim();
        const name = document.getElementById('eName').value.trim();
        if(!name) return alert("è«‹è¼¸å…¥å§“å");

        const data = { 
            id: id || Date.now(), 
            name: name, 
            dept: document.getElementById('eDept').value, 
            plate: document.getElementById('ePlate').value,
            time: new Date().toLocaleString()
        };

        db.ref(path + '/' + (id || name)).set(data)
        .then(() => alert("è³‡æ–™åº«åŒæ­¥æˆåŠŸï¼"))
        .catch(err => alert("æ¬Šé™ä¸è¶³ï¼è«‹å…ˆåœ¨ Firebase ç™»å…¥å¸³è™Ÿã€‚"));
    }

    // ç›£æ§è¨ªå®¢èˆ‡äº¤æ¥ (åšæ³• A çš„ read: true éƒ¨åˆ†)
    db.ref('visitor_logs').limitToLast(5).on('value', s => {
        const v = s.val(), target = document.getElementById('vLogs'); target.innerHTML = '';
        if(v) Object.values(v).reverse().forEach(x => target.innerHTML += `<div style="font-size:10px; margin-bottom:5px;">${x.name} - ${x.timeIn}</div>`);
    });

    function upK9() {
        const name = document.getElementById('k9Name').value;
        const note = document.getElementById('k9Note').value;
        db.ref('k9Logs/' + name).push({ note, timestamp: Date.now() });
    }
</script>
</body>
</html>
